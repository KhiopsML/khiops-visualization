<div id="unfold-hierarchy-comp" fxFlexFill #unfoldHierarchy fxLayout="row">
  <div
    fxLayout="column"
    fxFlexFill
    fxLayoutAlign="center center"
    *ngIf="!clustersPerDimDatas || loadingHierarchy"
  >
    <mat-spinner
      diameter="40"
      color="accent"
      mode="indeterminate"
    ></mat-spinner>
  </div>
  <div
    fxFlexFill
    fxLayout="column"
    *ngIf="clustersPerDimDatas && !loadingHierarchy"
  >
    <kl-unfold-hierarchy-header
      (cancel)="onClickOnCancel()"
      (save)="onClickOnSave()"
    ></kl-unfold-hierarchy-header>

    <as-split id="unfold-hierarchy-content" direction="horizontal">
      <as-split-area fxLayout="column">
        <kl-unfold-hierarchy-settings
          [currentUnfoldHierarchy]="currentUnfoldHierarchy"
          [hierarchyDatas]="hierarchyDatas"
          [currentCellsPerCluster]="currentCellsPerCluster"
          [currentInformationPerCluster]="currentInformationPerCluster"
          [cyInput]="cyInput"
          (hierarchyChanged)="onHierarchyChanged($event)"
          (increase)="increaseUnfoldHierarchy()"
          (decrease)="decreaseUnfoldHierarchy()"
          (cyInputSet)="setCypressInput($event)"
        ></kl-unfold-hierarchy-settings>

        <kl-ag-grid
          fxFlex
          id="unfold-hierarchy-table"
          class="kl-card"
          [showSearch]="false"
          [showColumnsSelection]="false"
          [inputDatas]="dimensions"
          [title]="unfoldHierarchyTableTitle"
          (gridCheckboxChanged)="onGridCheckboxChanged($event)"
          [rowSelection]="'multiple'"
          [displayedColumns]="hierarchyDisplayedColumns"
        ></kl-ag-grid>
      </as-split-area>
      <as-split-area fxLayout="column">
        <as-split direction="vertical" disabled="true">
          <as-split-area fxLayout="column">
            <div fxFlex fxLayout="column" class="kl-card">
              <div
                fxLayout="row"
                fxLayoutAlign="start center"
                class="comp-header"
              >
                <div fxFlex fxLayout="row" fxLayoutAlign="start center">
                  <h1>{{ 'GLOBAL.INFORMATION_RATE' | translate }}</h1>
                </div>
              </div>
              <kl-chart
                title="{{
                  'TOOLTIPS.AXIS.UNFOLD_HIERARCHY.INFO_RATE_CHART' | translate
                }}"
                [canvasIdContainer]="'info-per-cluster-graph'"
                fxFlex
                [inputDatas]="infoPerCluster"
                [enableSelection]="false"
                [colorSet]="colorSetInfoPerCluster"
                [chartOptions]="infoPerClusterChartOptions"
              >
              </kl-chart>
            </div>
          </as-split-area>

          <as-split-area fxLayout="column">
            <kl-unfold-hierarchy-clusters-graph
              fxFlexFill
              [legend]="legend"
              [colorSetClusterPerDim]="colorSetClusterPerDim"
              [clustersPerDimDatas]="clustersPerDimDatas"
              [selectedLineChartItem]="selectedLineChartItem"
              [clustersPerDimDatasChartOptions]="
                clustersPerDimDatasChartOptions
              "
              (legendItemClicked)="highlightChartLine($event)"
            ></kl-unfold-hierarchy-clusters-graph>
          </as-split-area>
        </as-split>
      </as-split-area>
    </as-split>
  </div>
</div>
